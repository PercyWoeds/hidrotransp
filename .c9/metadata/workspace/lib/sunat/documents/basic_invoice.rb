{"filter":false,"title":"basic_invoice.rb","tooltip":"/lib/sunat/documents/basic_invoice.rb","undoManager":{"mark":15,"position":15,"stack":[[{"start":{"row":133,"column":68},"end":{"row":134,"column":0},"action":"insert","lines":["",""],"id":15},{"start":{"row":134,"column":0},"end":{"row":134,"column":42},"action":"insert","lines":["                                          "]}],[{"start":{"row":134,"column":42},"end":{"row":134,"column":66},"action":"insert","lines":["columns([3]).width= 250 "],"id":16}],[{"start":{"row":134,"column":66},"end":{"row":135,"column":0},"action":"insert","lines":["",""],"id":17},{"start":{"row":135,"column":0},"end":{"row":135,"column":42},"action":"insert","lines":["                                          "]}],[{"start":{"row":152,"column":5},"end":{"row":152,"column":6},"action":"insert","lines":["#"],"id":18}],[{"start":{"row":152,"column":112},"end":{"row":153,"column":0},"action":"insert","lines":["",""],"id":19},{"start":{"row":153,"column":0},"end":{"row":153,"column":5},"action":"insert","lines":["     "]}],[{"start":{"row":153,"column":5},"end":{"row":153,"column":21},"action":"insert","lines":["pdf.move_down 20"],"id":20}],[{"start":{"row":153,"column":21},"end":{"row":154,"column":0},"action":"insert","lines":["",""],"id":21},{"start":{"row":154,"column":0},"end":{"row":154,"column":5},"action":"insert","lines":["     "]}],[{"start":{"row":154,"column":5},"end":{"row":155,"column":0},"action":"insert","lines":["",""],"id":22},{"start":{"row":155,"column":0},"end":{"row":155,"column":5},"action":"insert","lines":["     "]}],[{"start":{"row":141,"column":6},"end":{"row":157,"column":0},"action":"remove","lines":["pdf.move_down 10","","      pdf.table invoice_summary, {","        :position => :right,","        :cell_style => {:border_width => 1},","        :width => pdf.bounds.width/2","      } do","        columns([0]).font_style = :bold","        columns([1]).align = :right","        ","      end","     #  pdf.image open(\"https://chart.googleapis.com/chart?chs=120x120&cht=qr&chl=#{$lcCodigoBarra}&choe=UTF-8\")","     pdf.move_down 20","     ","     ","      pdf",""],"id":23}],[{"start":{"row":141,"column":6},"end":{"row":181,"column":0},"action":"insert","lines":[" pdf.move_down 30","      ","       ","      ","      pdf.move_down 30","      ","","      pdf.table invoice_summary, {","        :position => :right,","        :cell_style => {:border_width => 1},","        :width => 260","      } do","        columns([0]).font_style = :bold","        columns([1]).align = :right","        columns([0]).higth = 20","        columns([1]).higth = 20","        ","    ","      end","      #pdf.image open(\"https://chart.googleapis.com/chart?chs=100x100&cht=qr&chl=#{$lcCodigoBarra}&choe=UTF-8\")","      ","      pdf.move_down 20","      ","      pdf.table letras, {","        :position => :right,","        :cell_style => {:border_width => 0},","        :width => pdf.bounds.width","      } do","        columns([0]).font_style = :bold","        columns([1]).align = :left","        columns([0]).width = 50","        ","        ","      end","      ","     ","       pdf.move_down 10","       ","      ","      pdf",""],"id":24}],[{"start":{"row":242,"column":7},"end":{"row":243,"column":0},"action":"insert","lines":["",""],"id":25},{"start":{"row":243,"column":0},"end":{"row":243,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":243,"column":4},"end":{"row":244,"column":0},"action":"insert","lines":["",""],"id":26},{"start":{"row":244,"column":0},"end":{"row":244,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":244,"column":4},"end":{"row":254,"column":8},"action":"insert","lines":[" def letras","       letras  = []","       if get_additional_property_by_id(SUNAT::ANNEX::CATALOG_15[0])","        total = get_additional_property_by_id(SUNAT::ANNEX::CATALOG_15[0]).value","      else","        total = legal_monetary_total.textify.upcase","      end","      letras  << [\"SON : \", ActiveSupport::NumberHelper::number_to_delimited(total,delimiter:\",\",separator:\".\")]","      ","      letras","    end "],"id":27}],[{"start":{"row":254,"column":8},"end":{"row":255,"column":0},"action":"insert","lines":["",""],"id":28},{"start":{"row":255,"column":0},"end":{"row":255,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":213,"column":4},"end":{"row":242,"column":7},"action":"remove","lines":["def invoice_summary","      invoice_summary = []","      monetary_totals = [{label: \"Operaciones gravadas\", catalog_index: 0},","       {label: \"Operaciones inafectas\", catalog_index: 1},","       {label: \"Operaciones exoneradas\", catalog_index: 2},","       {label: \"Operaciones gratuitas\", catalog_index: 3},","       {label: \"Sub total\", catalog_index: 4},","       {label: \"Total descuentos\", catalog_index: 9}","      ]","      monetary_totals.each do |monetary_total|","        value = get_monetary_total_by_id(SUNAT::ANNEX::CATALOG_14[monetary_total[:catalog_index]])","        if value.present?","          invoice_summary << [monetary_total[:label], ActiveSupport::NumberHelper::number_to_delimited(value.payable_amount,delimiter:\",\",separator:\".\").to_s]","        end","      end","","      tax_totals.each do |tax_total|","        invoice_summary << [tax_total.tax_type_name,ActiveSupport::NumberHelper::number_to_delimited(tax_total.tax_amount,delimiter:\",\",separator:\".\").to_s]","      end","","      invoice_summary << [\"Total\", ActiveSupport::NumberHelper::number_to_delimited(legal_monetary_total,delimiter:\",\",separator:\".\").to_s]","","      if get_additional_property_by_id(SUNAT::ANNEX::CATALOG_15[0])","        total = get_additional_property_by_id(SUNAT::ANNEX::CATALOG_15[0]).value","      else","        total = legal_monetary_total.textify.upcase","      end","      invoice_summary << [\"Monto del total\", ActiveSupport::NumberHelper::number_to_delimited(total,delimiter:\",\",separator:\".\")]","      invoice_summary","    end"],"id":29}],[{"start":{"row":213,"column":4},"end":{"row":242,"column":7},"action":"insert","lines":["  def invoice_summary","      invoice_summary = []","      monetary_totals = [{label: \"Total valor venta - Op.Gravadas\", catalog_index: 0},","       {label: \"Total valor venta - Op.Inafectas\", catalog_index: 1},","       {label: \"Total valor venta - Op.Exoneradas\", catalog_index: 2},","       {label: \"Total valor venta - Op.Gratuitas\", catalog_index: 3},","       {label: \"Total descuentos\", catalog_index: 9}","      ]","      monetary_totals.each do |monetary_total|","        value = get_monetary_total_by_id(SUNAT::ANNEX::CATALOG_14[monetary_total[:catalog_index]])","        if value.present?","            invoice_summary << [monetary_total[:label], ActiveSupport::NumberHelper::number_to_delimited(value.payable_amount,delimiter:\",\",separator:\".\").to_s]","       else ","           invoice_summary << [monetary_total[:label], ActiveSupport::NumberHelper::number_to_delimited(0.00,delimiter:\",\",separator:\".\").to_s]","       ","         end","        ","      end","","      tax_totals.each do |tax_total|","        invoice_summary << [tax_total.tax_type_name,ActiveSupport::NumberHelper::number_to_delimited(tax_total.tax_amount,delimiter:\",\",separator:\".\").to_s]","      end","","    ","    invoice_summary << [\"Total  a Pagar \", ActiveSupport::NumberHelper::number_to_delimited(legal_monetary_total,delimiter:\",\",separator:\".\").to_s]","    ","    ","     ","      invoice_summary","    end"],"id":30}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":242,"column":7},"end":{"row":242,"column":7},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1558369380154,"hash":"348571566903ae50deff0b9c44af6d07df068beb"}